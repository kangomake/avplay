//
//  MeituanViewModel.m
//  CRPlayer
//
//  Created by appleDeveloper on 2020/11/11.
//  Copyright © 2020 appleDeveloper. All rights reserved.
//

#import "MeituanViewModel.h"

@implementation MeituanViewModel

+ (void)GetShopData:(void(^)(NSMutableArray * dataArray))shopDataBlock{
    
    NSMutableArray *array = [NSMutableArray new];
    
    NSDictionary *dic1 = @{@"id": @9323283,
                           @"name": @"马可波罗意面",
                           @"min_price": @12.0,
                           @"praise_num": @20,
                           @"picture":@"1.png",
                           @"month_saled":@12};
    
    NSDictionary *dic2 = @{@"id": @9323284,
                           @"name": @"鲜珍焗面",
                           @"min_price": @28.0,
                           @"praise_num": @6,
                           @"picture":@"2.png",
                           @"month_saled":@34};
    
    NSDictionary *dic3 = @{@"id": @9323285,
                           @"name": @"经典焗面",
                           @"min_price": @28.0,
                           @"praise_num": @8,
                           @"picture":@"3.png",
                           @"month_saled":@16};
    
    NSDictionary *dic4 = @{@"id": @26844943,
                           @"name": @"摩洛哥烤肉焗饭",
                           @"min_price": @32.0,
                           @"praise_num": @1,
                           @"picture":@"4.png",
                           @"month_saled":@56};
    
    NSDictionary *dic5 = @{@"id": @9323279,
                           @"name": @"莎莎鸡肉饭",
                           @"min_price": @29.0,
                           @"praise_num": @11,
                           @"picture":@"5.png",
                           @"month_saled":@11};
    
    NSDictionary *dic6 = @{@"id": @9323289,
                           @"name": @"曼哈顿海鲜巧达汤",
                           @"min_price": @22.0,
                           @"praise_num": @2,
                           @"picture":@"6.png",
                           @"month_saled":@5};
    
    NSDictionary *dic7 = @{@"id": @9323243,
                           @"name": @"意式香辣12寸传统",
                           @"min_price": @72.0,
                           @"praise_num": @0,
                           @"picture":@"7.png",
                           @"month_saled":@19};
    
    NSDictionary *dic8 = @{@"id": @9323220,
                           @"name": @"超级棒约翰9寸卷边",
                           @"min_price": @64.0,
                           @"praise_num": @28,
                           @"picture":@"8.png",
                           @"month_saled":@7};
    
    NSDictionary *dic9 = @{@"id": @9323280,
                           @"name": @"牛肉培根焗饭",
                           @"min_price": @30.0,
                           @"praise_num": @48,
                           @"picture":@"9.png",
                           @"month_saled":@0};
    
    NSDictionary *dic10 = @{@"id": @9323267,
                            @"name": @"胡椒薯格",
                            @"min_price": @16.0,
                            @"praise_num": @9,
                            @"picture":@"10.png",
                            @"month_saled":@136};
    
    
    array = [@[[dic1 mutableCopy],[dic2 mutableCopy],[dic3 mutableCopy],[dic4 mutableCopy],[dic5 mutableCopy],[dic6 mutableCopy],[dic7 mutableCopy],[dic8 mutableCopy],[dic9 mutableCopy],[dic10 mutableCopy]] mutableCopy];
    
    shopDataBlock(array);
    
}

#pragma  mark - 计算价格
+ (double)GetTotalPrice:(NSMutableArray *)dataArray{
    
    double nTotal = 0;
    return nTotal;
    
}

#pragma mark - 计算订单数据
+ (NSMutableArray *)storeOrders:(NSMutableDictionary *)dictionary OrderData:(NSMutableArray *)orderArray isAdded:(BOOL)added{
    
    NSMutableDictionary *dict = [NSMutableDictionary dictionaryWithDictionary:dictionary];
    if(added){
        
        if(orderArray.count != 0){
            BOOL flage = YES;
            for(NSMutableDictionary *dict in orderArray){
                if(dict[@"id"] == dict[@"id"]){
                    NSInteger count = [dict[@"orderCount"] integerValue];
                    [dict setValue:[NSString stringWithFormat:@"%ld",(long)count] forKey:@"orderCount"];
                    flage = NO;
                    break;
                    
                }
            }
            
            if(flage){
                [orderArray addObject:dict];
            }
            
        }else{
            [orderArray addObject:dict];
        }
        
        
    }else{
        
        for(int i = 0; i<orderArray.count;i++){
            NSMutableDictionary *dic = orderArray[i];
            
            if(dic[@"id"] == dict[@"id"]){
                
                if([dict[@"orderCount"] integerValue] == 0){
                    [orderArray removeObjectAtIndex:i];
                    break;
                }
                
                if([dic[@"orderCount"] integerValue] == 0){
                    [orderArray removeObjectAtIndex:i];
                    
                }else{
                    [dic setValue:[NSString stringWithFormat:@"%@",dict[@"orderCount"]] forKey:@"orderCount"];
                }
                
                break;
            }
        }
    }
    
    
    return orderArray;
    
}

#pragma  mark - 计算数量
+(NSInteger) CountOthersWithorderData:(NSMutableArray *)ordersArray{
    
    NSInteger count = 0;
    for(int i = 0;i < ordersArray.count;i++){
        NSMutableDictionary *dic = ordersArray[i];
        count += [dic[@"orderCount"] integerValue];
    }
    
    return count;
}

#pragma mark - 更新显示数据
+(NSMutableArray *)UpdateArray:(NSMutableArray *)dataArray atSelectDictionary:(NSMutableDictionary *)dictionary{
    
    for (NSMutableDictionary *dict in dataArray){
        if(dict[@"id"] == dictionary[@"id"]){
            
            NSInteger count = [dictionary[@"orderCount"] integerValue];
            [dict setValue:[NSString stringWithFormat:@"%ld",(long)count] forKey:@"orderCount"];
            break;
        }
    }
    return  dataArray;
}


@end
